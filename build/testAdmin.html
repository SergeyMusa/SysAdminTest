<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="css/index.css">
    <link rel="stylesheet" type="text/css" href="css/test.css">
    <link href="https://fonts.googleapis.com/css?family=Faster+One" rel="stylesheet">
    <head> 
      <link rel="icon" href="./img/favicon.ico">
      <title>SysAdminTest</title>
    </head>
  </head>
</html>
<div class="page-wrapper" id="pageWrapper">
  <head> 
    <link rel="icon" href="./img/favicon.ico">
    <title>SysAdminTest</title>
  </head>
  <header>
    <!-- верхнее меню-->
    <nav class="navbar navbar-light" style="background-color: #e3fde9">
      <div class="container-fluid"><a class="navbar-brand" href="#"><img class="d-inline-block align-text-top" src="./img/daemon.jpg" alt="" width="35" height="30">SysAdminTest</a>
        <form class="d-flex">
          <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
          <button class="btn btn-outline-success" type="submit">Search</button>
        </form>
      </div>
    </nav>
  </header>
  <body id="test">
    <div class="container">
      <div>
        <p>
          Требуется авторизоваться, чтобы пройти тесты; ваши данные нужны только для
          статистики и никуда не будут переданы ).
        </p>
        <div class="form-check form-switch">
          <input class="form-check-input" id="flexSwitchCheckDefault" type="checkbox">
          <label class="form-check-label" for="flexSwitchCheckDefault">авторизоваться, чтобы пройти тесты</label>
          <script src="js/main.min.js"></script>
        </div>
        <form action="">
          <div class="row">
            <div class="col">
              <input class="form-control" id="userName" type="text" placeholder="Штирлиц" disabled="true" label="qwe">
            </div>
            <div class="col">
              <input class="form-control" id="userOrg" type="text" placeholder="ООО Тайное Общество" disabled="true" required="true">
            </div>
            <div class="col">
              <button class="btn btn-success" id="userButton" onclick="userFunction()" type="button" disabled="true">Success</button>
            </div>
          </div>
        </form>
      </div>
      <section>
        <p>имя и орг перенести из джсон в кукисы</p>
        <p>добавить таймер</p>
        <script src="js/parsimJson.js"></script>
      </section>
      <script>
        // alert( document.cookie userName);
        // userName
        // userOrg
        // Cookies.get('userName'); // => "valueCookie"
        
        // console.log( Cookies.get('userName') );
        
        const header = document.querySelector("header");
        const section = document.querySelector("section");
        
        let requestURL = "./json/test.json";
        
        let request = new XMLHttpRequest();
        request.open("GET", requestURL);
        request.responseType = "json";
        request.send();
        
        request.onload = function () {
        const sysAdminTest = request.response;
        populateHeader(sysAdminTest);
        showTest(sysAdminTest);
        };
        
        function populateHeader(obj) {
        const myH1 = document.createElement("h1");
        myH1.textContent = obj["testSysadmin"];
        header.appendChild(myH1);
        
        const user = document.createElement("p");
        user.textContent =
        "Тест проходит: " +
        obj["intervieweeName"] +
        " из организации: " +
        obj["intervieweeOrg"];
        // user.textContent = 'Тест проходит: ' +  (document.cookie = user) + ' из организации: ' + (document.cookie = org);
        
        header.appendChild(user);
        
        const userRezult = document.createElement("p");
        userRezult.textContent =
        "Результаты теста: " +
        obj["result"] +
        " использовано попыток " +
        obj["attempt"];
        header.appendChild(userRezult);
        }
        
        function showTest(obj) {
        const questions = obj["survey"];
        
        for (let i = 0; i < questions.length; i++) {
        // console.log(questions.length);
        const myArticle = document.createElement("article");
        const myH2 = document.createElement("h2");
        const myPara1 = document.createElement("p");
        const myPara2 = document.createElement("p");
        const myPara3 = document.createElement("p");
        
        // const myList = document.createElement("ul");
        
        myArticle.setAttribute("class", "test3");
        
        myH2.textContent = questions[i].numberTest;
        myPara1.textContent = "Вопрос: " + questions[i].question;
        myPara2.textContent = "Варианты ответов: " + questions[i].answers;
        myPara3.textContent =
        "Правильный ответ: " +
        questions[i].right +
        " - " +
        questions[i].justification;
        
        const radioAnswerList = document.createElement("div");
        
        const variantAnsver = questions[i].answers;
        console.log(variantAnsver)
        for (let j = 0; j < variantAnsver.length; j++) {
        // const listItem = document.createElement("li");
        const radioAnswer = document.createElement("div");
        
        radioAnswer.innerHTML =
        `<input type='radio' name='answer' value="${j}"> <label for='${j}'>${variantAnsver[j]}</label>`;
        // const listItem = document.createElement("radio");
        // listItem.textContent = variantAnsver[j];
        // radioAnswer.appendChild(listItem);
        radioAnswerList.appendChild(radioAnswer)
        }
        
        myArticle.appendChild(myH2);
        myArticle.appendChild(myPara1);
        //
        myArticle.appendChild(radioAnswerList);
        
        myArticle.appendChild(myPara3);
        // ответ
        section.appendChild(myArticle);
        // myArticle.appendChild(myPara2);
        }
        }
      </script>
    </div>
  </body>
  <div class="page-wrapper" id="pageWrapper">
    <footer class="page-footer font-small blue" style="width: 100%">
      <section class="footer-copyright text-center py-3">
        <hr>
        <p>добавить оценку теста +-</p>
        <p>средний результат</p>
        <p>печать результата или отправить на почту</p>
        <p>сделать своою выборку тестов</p>
        <p>форма отзывов: ошибки или предложения</p>
        <p>
          id теста, показывает количество вызовов за день(чтобы не откатывали
          назад - не жульничали)
        </p>
        <p>таймер</p>
      </section>
      <hr>
      <div class="footer-copyright text-center py-3">© 2021 Copyright</div>
    </footer>
  </div>
</div>